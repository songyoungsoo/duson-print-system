<?php
declare(strict_types=1);

// ✅ PHP 7.4 호환: 입력 변수 초기화
$mode = $_GET['mode'] ?? $_POST['mode'] ?? '';
$no = $_GET['no'] ?? $_POST['no'] ?? '';
$search = $_GET['search'] ?? $_POST['search'] ?? '';
$id = $_GET['id'] ?? $_POST['id'] ?? '';
$name = $_GET['name'] ?? $_POST['name'] ?? '';
$code = $_GET['code'] ?? $_POST['code'] ?? '';
$page = $_GET['page'] ?? $_POST['page'] ?? '';

if(is_uploaded_file($photofile_1)) {

	$full_filename = split("\.", $photofile_1_name);
	$file_extention = $full_filename[sizeof($photofile_1_name)];

	if (eregi($file_extention, "html|php3|phtml|inc|asp")) {
		$msg = "\\n사진자료를 업로드중에 문제가 발생하였습니다.\\n\\n회원정보수정에서 사진자료를 재입력하시면 됩니다.\\n\\n문제요인: php / asp 관련파일은 직접 업로드 하실 수 없습니다.\\n\\n파일의 확장자를 변경하여 올려 주세요.\\n";
		echo ("<script language=javascript>
                     window.alert('$msg');
                  </script>");
	}

 	if( $MAXFSIZE * 1024 < $photofile_1_size) {
		$photofile_1_kfsize = intval($photofile_1_size/1024);
		$msg = "\\n사진자료를 업로드중에 문제가 발생하였습니다.\\n\\n회원정보수정에서 사진자료를 재입력하시면 됩니다.\\n\\n문제요인: 업로드하신 파일의 크기가 $photofile_1_kfsize KB입니다. 관리자가 제한한 용량은 $MAXFSIZE KB입니다.";
		echo ("<script language=javascript>
                     window.alert('$msg');
                  </script>");
	}

//---------------------------------------------------------------------------------------------------------------//
$MlangHanGulChange = "$photofile_1_name";
if(eregi ("(([^/a-zA-Z]){1,})(\.jpg|\.jpeg|\.bmp|\.png|\.gif)", $MlangHanGulChange ,$MlangHanGulregs)){
$MlangHanGulCode_date=date("YmdHis");  $MlangHanGulCode_end=1014; $MlangHanGulCode_num=rand(0,$MlangHanGulCode_end);  
$MlangHanGulCodeOK="${MlangHanGulCode_date}${MlangHanGulCode_num}";
$photofile_1_name = eregi_replace ($MlangHanGulregs[1], "$MlangHanGulCodeOK",$MlangHanGulChange);
}else{
$photofile_1_name = $photofile_1_name;
}
//---------------------------------------------------------------------------------------------------------------//

	if (is_file("$upload_dir/$photofile_1_name")) {
		$photofile_1_name = date("is")."_$photofile_1_name";
	}
	if ($photofile_1_size) {
	move_uploaded_file($photofile_1, "$upload_dir/$photofile_1_name");
	}
}

$photofile_1Name = $photofile_1_name;
?>