# 한글 입력 모드 자동 유지 프로그램

영문으로 직접 전환하지 않는 한 자동으로 한글 입력 모드를 유지하는 윈도우 프로그램입니다.

## 주요 기능

- 🔄 **자동 한글 모드 유지**: 새 창으로 포커스가 이동해도 자동으로 한글 입력 모드로 설정
- 🧠 **스마트 감지**: 사용자가 직접 영문으로 전환한 경우는 감지하여 자동 전환하지 않음
- 🎯 **백그라운드 실행**: 시스템 트레이에서 조용히 실행
- ⚙️ **간편한 제어**: 시스템 트레이에서 활성화/비활성화 토글 가능

## 설치 방법

### 1. Python 설치
Python 3.8 이상이 필요합니다. [Python 공식 사이트](https://www.python.org/downloads/)에서 다운로드하세요.

### 2. 필요한 패키지 설치

```bash
pip install -r requirements.txt
```

또는 개별 설치:

```bash
pip install pystray pillow pywin32
```

## 실행 방법

```bash
python korean_input_keeper.py
```

프로그램이 시작되면 시스템 트레이에 '한' 아이콘이 나타납니다.

## 사용 방법

1. **시스템 트레이 아이콘 확인**: 프로그램이 실행되면 작업 표시줄 우측 하단에 파란색 '한' 아이콘이 나타납니다.

2. **활성화/비활성화**: 아이콘을 우클릭하여 메뉴를 열고 "활성화/비활성화"를 선택하면 기능을 끄거나 켤 수 있습니다.

3. **종료**: 메뉴에서 "종료"를 선택하면 프로그램이 종료됩니다.

## 작동 원리

### 자동 한글 모드 전환
- 새 프로그램이나 텍스트 입력 창으로 포커스가 이동하면 자동으로 한글 입력 모드로 전환
- 0.5초마다 입력 모드를 체크

### 사용자 의도 존중
- 사용자가 Shift 또는 한/영 키를 눌러 영문으로 전환한 경우 감지
- 사용자가 영문으로 전환한 경우 자동으로 한글로 되돌리지 않음
- 사용자가 다시 한글로 전환하면 자동 모드 재개

## 자동 시작 설정 (선택사항)

### 방법 1: 시작 프로그램 폴더에 바로가기 추가

1. `Win + R` 키를 누르고 `shell:startup` 입력
2. 열리는 폴더에 `korean_input_keeper.py`의 바로가기를 추가
3. 바로가기 속성에서 대상을 다음과 같이 설정:
   ```
   pythonw.exe "C:\경로\korean_input_keeper.py"
   ```

### 방법 2: 작업 스케줄러 사용

1. 작업 스케줄러 실행
2. "기본 작업 만들기" 선택
3. 트리거: "로그온할 때"
4. 작업: 프로그램 시작
5. 프로그램: `pythonw.exe`
6. 인수: `"C:\경로\korean_input_keeper.py"`

## EXE 파일로 변환 (선택사항)

pyinstaller를 사용하여 단일 실행 파일로 만들 수 있습니다:

```bash
pip install pyinstaller
pyinstaller --onefile --windowed --icon=icon.ico korean_input_keeper.py
```

## 문제 해결

### 프로그램이 실행되지 않을 때
- Python이 올바르게 설치되었는지 확인
- 필요한 패키지가 모두 설치되었는지 확인
- 관리자 권한으로 실행 시도

### 한글 전환이 작동하지 않을 때
- 시스템 트레이에서 프로그램이 "활성화됨" 상태인지 확인
- Windows IME가 설치되어 있는지 확인
- 일부 프로그램은 IME 제어가 제한될 수 있음

## 시스템 요구사항

- Windows 10/11
- Python 3.8 이상
- 한글 IME 설치

## 라이선스

MIT License
