# 🚀 Cafe24 마이그레이션 자동화 도구

**XAMPP → Cafe24 Linux 환경 마이그레이션을 위한 통합 자동화 솔루션**

---

## 📁 **파일 구성**

```
automation/
├── README.md                      # 📚 이 파일 (개요)
├── MASTER_MIGRATION_GUIDE.md      # 📖 통합 실행 가이드
├── MIGRATION_WORKFLOW_GUIDE.md    # 🔄 전체 워크플로우 상세
├── package_for_cafe24.php         # 🛠️ 자동 배포 패키징 스크립트  
├── validate_deployment.php        # 🧪 배포 후 자동 검증 스크립트
└── deployment_checklist.md        # ✅ 10분 수동 체크리스트
```

---

## ⚡ **빠른 시작**

### 1️⃣ 자동 배포 패키지 생성 (5분)
```bash
cd C:\xampp\htdocs\automation
php package_for_cafe24.php
```
**결과**: `deployment/cafe24_deploy_YYYYMMDD_HHMMSS.zip` 생성

### 2️⃣ 카페24 서버 배포 (10분)  
1. FTP로 ZIP 파일 업로드
2. 파일매니저에서 압축 해제
3. 파일 권한 설정 (755/644/775)

### 3️⃣ 자동 검증 실행 (3분)
```bash
# 웹에서 실행
http://dsp1830.shop/automation/validate_deployment.php

# SSH에서 실행  
php validate_deployment.php
```

### 4️⃣ 수동 체크리스트 (10분)
`deployment_checklist.md` 파일 참조하여 핵심 기능 테스트

---

## 🎯 **주요 기능**

### 🛠️ **package_for_cafe24.php**
- **자동 경로 변환**: Windows 경로 → Linux 경로
- **인코딩 통일**: UTF-8 BOM 제거, LF 통일
- **불필요 파일 제외**: 개발/테스트/백업 파일 자동 제외
- **설정 파일 생성**: .htaccess, .user.ini, database.php 자동 생성
- **환경별 DB 설정**: 로컬/프로덕션 자동 감지

### 🧪 **validate_deployment.php**  
- **HTTP 응답 테스트**: 9개 주요 페이지 상태 확인
- **데이터베이스 검증**: 연결, 문자셋, 테이블 존재 확인
- **PHP 환경 검사**: 버전, 확장모듈, 설정값 확인
- **보안 검증**: 민감파일 차단, 디렉토리 브라우징 방지
- **성능 측정**: 응답시간, 메모리 사용량 모니터링

### ✅ **deployment_checklist.md**
- **시간별 체크포인트**: 10분 완주 가이드
- **우선순위 테스트**: 핵심 기능부터 단계별 검증  
- **문제별 대응방법**: HTTP 500, 계산 오류, 업로드 실패 등
- **성공/실패 기준**: 명확한 판정 기준 제시

---

## 📊 **성공 기준**

### ✅ **배포 성공 기준**
- 자동 검증 성공률 **90% 이상**
- 핵심 견적 계산 기능 **100% 정상**
- 응답시간 **3초 이내** (메인 페이지)
- 에러 로그 **치명적 오류 0건**

### ⚠️ **주의 기준** 
- 자동 검증 성공률 **70-89%**
- 일부 기능 오류 (전체 20% 미만)
- 성능 저하 (5초 이내)

### ❌ **롤백 기준**
- 자동 검증 성공률 **70% 미만** 
- 메인 페이지 접속 불가
- 데이터베이스 연결 실패

---

## 🔧 **트러블슈팅**

### **HTTP 500 오류**
```bash
# 에러 로그 확인
tail -50 logs/php-error.log

# 권한 재설정
chmod 644 *.php; chmod 755 */; chmod 775 uploads logs
```

### **견적 계산 실패**
```javascript  
// 브라우저 개발자도구에서 실행
console.log("AJAX 요청 테스트");
fetch('/MlangPrintAuto/msticker/')
  .then(r => r.text())
  .then(html => console.log(html.substring(0,200)));
```

### **DB 연결 오류**
```bash
# 연결 테스트
mysql -u dsp1830 -p dsp1830 -e "SELECT 1;"

# 설정 확인  
cat config/database.php | grep -E "(host|user|password)"
```

---

## 📋 **사용 시나리오**

### **시나리오 1: 정상 배포** (총 30분)
1. **패키징** (5분): `package_for_cafe24.php` 실행
2. **업로드** (10분): FTP로 ZIP 업로드 및 압축해제  
3. **검증** (10분): 자동 + 수동 검증
4. **모니터링** (5분): 실시간 로그 모니터링 설정
5. **결과**: ✅ 성공률 95%, 모든 기능 정상

### **시나리오 2: 부분 오류** (총 45분)
1. **패키징** (5분): 정상
2. **업로드** (10분): 정상
3. **검증** (15분): 자동 검증 75%, 일부 제품 오류 발견
4. **수정** (10분): 특정 파일 롤백, 권한 재설정
5. **재검증** (5분): 성공률 90% 달성
6. **결과**: ⚠️ 주의사항 해결 후 정상 운영

### **시나리오 3: 긴급 롤백** (총 20분) 
1. **패키징** (5분): 정상
2. **업로드** (5분): 정상  
3. **검증** (3분): 자동 검증 40%, 메인 페이지 500 오류
4. **즉시 롤백** (7분): 백업 파일로 완전 복구
5. **결과**: ❌ 롤백 완료, 원인 분석 후 재배포 계획

---

## 🔄 **지속적 개선**

### **v1.1 예정 기능** (1주 후)
- [ ] 성능 최적화 자동 적용
- [ ] 보안 강화 옵션 추가
- [ ] 롤백 자동화 스크립트

### **v1.2 예정 기능** (1개월 후)  
- [ ] 배포 이력 관리
- [ ] 성능 모니터링 대시보드
- [ ] 알림 시스템 통합

---

## 📞 **지원**

### **사용 방법 문의**
- 각 스크립트는 실행시 상세한 가이드를 출력합니다
- `MASTER_MIGRATION_GUIDE.md`에서 전체 과정을 확인하세요

### **오류 신고** 
- 스크립트 실행 로그를 함께 제공해주세요
- 환경 정보 (PHP 버전, OS, 호스팅)를 명시해주세요

### **기여 방법**
- 실제 사용 경험을 바탕으로 가이드 개선에 참여하세요
- 새로운 문제 상황과 해결 방법을 공유해주세요

---

**🎉 성공적인 마이그레이션을 위해 준비된 모든 도구입니다!**  
**단계별 가이드를 따라 안전하고 신속한 배포를 진행하세요.**