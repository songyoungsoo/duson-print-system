# 📎 품목별 파일 업로드 기능 적용 가이드

## 📅 작성일: 2025년 8월 4일

---

## 🎯 **적용 대상 품목들**

### **현재 상태 확인:**
- ❌ **msticker** - 파일 업로드 기능 미적용
- ❌ **ncrflambeau** - 파일 업로드 기능 미적용  
- ❌ **littleprint** - 파일 업로드 기능 미적용
- ❌ **envelope** - 파일 업로드 기능 미적용
- ❌ **namecard** - 파일 업로드 기능 미적용
- ❌ **merchandisebond** - 파일 업로드 기능 미적용

---

## 🔧 **적용 방법 (단계별)**

### **1단계: add_to_basket.php 파일 수정**

각 품목의 `add_to_basket.php` 파일에 다음 내용 추가:

```php
// 기존 include 문 다음에 추가
include "../shop/file_management_helper.php";

// 장바구니 추가 성공 후 파일 처리 로직 추가
if ($cart_item_no && isset($_FILES['files'])) {
    $log_info = generateFileLogInfo($product_type);
    $upload_dir = createFileUploadDirectory($log_info);
    
    $uploaded_files = [];
    $files = $_FILES['files'];
    $file_count = count($files['name']);
    
    for ($i = 0; $i < $file_count; $i++) {
        if ($files['error'][$i] !== UPLOAD_ERR_OK) continue;
        
        // 파일 검증 및 저장 로직
        // (upgrade_add_to_basket_example.php 참조)
    }
}
```

### **2단계: index.php 파일에 파일 업로드 UI 추가**

각 품목의 메인 페이지에 파일 업로드 섹션 추가:

```php
// 파일 업로드 컴포넌트 포함
include "../../includes/file_upload_component.php";

// HTML에서 사용
<?php 
$log_info = generateLogInfo();
renderFileUploadComponent($log_info, 'msticker'); 
?>
```

### **3단계: JavaScript 연동**

폼 제출 시 파일도 함께 전송하도록 수정:

```javascript
// 기존 AJAX 호출에 파일 추가
const formData = new FormData();
formData.append('MY_type', MY_type);
formData.append('PN_type', PN_type);
// ... 기존 데이터들

// 파일 추가
const fileInput = document.querySelector('input[type="file"]');
if (fileInput && fileInput.files.length > 0) {
    for (let i = 0; i < fileInput.files.length; i++) {
        formData.append('files[]', fileInput.files[i]);
    }
}

fetch('add_to_basket.php', {
    method: 'POST',
    body: formData
});
```

---

## 📋 **품목별 적용 체크리스트**

### **msticker (자석스티커):**
- [ ] `MlangPrintAuto/msticker/add_to_basket.php` 수정
- [ ] `MlangPrintAuto/msticker/index.php` 파일 업로드 UI 추가
- [ ] JavaScript 파일 전송 로직 추가
- [ ] 테스트 실행

### **ncrflambeau (양식지):**
- [ ] `MlangPrintAuto/ncrflambeau/add_to_basket.php` 수정
- [ ] `MlangPrintAuto/ncrflambeau/index.php` 파일 업로드 UI 추가
- [ ] JavaScript 파일 전송 로직 추가
- [ ] 테스트 실행

### **littleprint (포스터):**
- [ ] `MlangPrintAuto/littleprint/add_to_basket.php` 수정
- [ ] `MlangPrintAuto/littleprint/index.php` 파일 업로드 UI 추가
- [ ] JavaScript 파일 전송 로직 추가
- [ ] 테스트 실행

### **기타 품목들:**
- [ ] envelope, namecard, merchandisebond 순차 적용

---

## 🧪 **테스트 방법**

각 품목 적용 후 다음 테스트 실행:

1. **파일 업로드 테스트**
   - 파일 선택 → 장바구니 추가 → 파일이 저장되는지 확인

2. **장바구니 확인**
   - 장바구니 페이지에서 파일 정보 표시 확인

3. **주문 연동**
   - 주문 완료 시 파일 정보가 주문 테이블로 이전되는지 확인

---

## ⚠️ **주의사항**

1. **경로 확인**: 각 품목별로 상대 경로가 다를 수 있음
2. **필드명 통일**: 모든 품목에서 동일한 필드명 사용
3. **에러 처리**: 파일 업로드 실패 시 적절한 에러 메시지 표시
4. **용량 제한**: 파일 크기 및 개수 제한 설정

---

## 🚀 **우선 적용 순서**

1. **msticker** - 가장 단순한 구조
2. **ncrflambeau** - 이미 완성도가 높음
3. **littleprint** - 복잡한 드롭다운 구조
4. **나머지 품목들** - 순차적 적용

---

**다음 단계**: msticker부터 실제 적용 시작