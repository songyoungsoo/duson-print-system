<?php
declare(strict_types=1); if($mode=="form"){ ?>

<?
include"../title.php";
?>

<script language=javascript>

var NUM = "0123456789"; 
var SALPHA = "abcdefghijklmnopqrstuvwxyz";
var ALPHA = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"+SALPHA;

////////////////////////////////////////////////////////////////////////////////
function TypeCheck (s, spc) {
var i;

for(i=0; i< s.length; i++) {
if (spc.indexOf(s.substring(i, i+1)) < 0) {
return false;
}
}        
return true;
}

/////////////////////////////////////////////////////////////////////////////////

function AdminCheckField()
{
var f=document.AdminInfo;

if (f.menu.value == "") {
alert("메뉴에 대한 내용을 입력하여주세요");
return false;
}

}
</script>
</head>

<table border=0 align=center width=600 cellpadding='0' cellspacing='0'>

<tr><td align=center>
<BR><BR>
* {공백허용, 30자 이내} 로 입력 해주세요
<BR><BR>
	
<table border=0 align=center width=420 cellpadding='10' cellspacing='1' bgcolor='#000000'>
<form name='AdminInfo' method='post' OnSubmit='javascript:return AdminCheckField()' action='<?echo("$PHP_SELF");?>'>
<input type='hidden' name='mode' value='ok'>
</tr>
<tr>
<td bgcolor='#393839' width=100 align=center>
<font color='#FFFFFF'>메뉴 내용입력:</font>
</td>
<td bgcolor='#FFFFFF'>
<input type='text' size='40' name='menu' maxLength='30'>
</td>
</tr>
</table>

<p align=center>
<input type='submit' value=' 등록 합니다.'>
</p>
</form>
<BR><BR>
</td></tr>

</table>

<? 
} 

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

if($mode=="ok"){ 

include"../../db.php";

	$result = mysqli_query($db, "SELECT max(no) FROM $page_big_table");
	if (!$result) {
		echo "
			<script>
				window.alert(\"DB 접속 에러입니다!\")
				history.go(-1)
			</script>";
		exit;
	}
	$row = mysqli_fetch_row($result);

	if($row[0]) {
	   $new_no = $row[0] + 1;
	} else {
	   $new_no = 1;
	}   
############################################
//정보 입력
$dbinsert ="insert into $page_big_table values('$new_no',
'$menu'
)";
$result_insert= mysqli_query($db, $dbinsert,$db);

//완료 메세지를 보인후 페이지를 이동 시킨다
echo ("
		<script language=javascript>
		alert('\\n정상적으로 정보가 저장 되었습니다.\\n\\n');
        opener.parent.location=\"./page_menu_list.php\"; 
        window.self.close();
		</script>
		");
		exit;

}
?>