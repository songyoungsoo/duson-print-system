# 교정보기 인증 시스템 설명

## 🎯 혼란스러운 이유

교정보기(`/sub/checkboard.php`)는 **2개의 다른 인증 방식**을 동시에 사용합니다.

---

## 🔐 인증 시스템 구조

### 1️⃣ **일반 고객** - 전화번호 뒷자리 4자리 인증

**접근**: `http://localhost/sub/checkboard.php` (로그인 없이 접근 가능)

**인증 방식**:
- 주문번호를 클릭하면 비밀번호 모달 팝업 표시
- **전화번호 뒷자리 4자리** 입력
- `/sub/verify_popup.php`로 AJAX 검증
- 성공 시 해당 주문의 교정 이미지 팝업 표시

**코드 위치**: `/var/www/html/sub/checkboard.php` (225번 라인)
```javascript
onclick="showPasswordModal(<?php echo $order['no']; ?>,
         '<?php echo htmlspecialchars($order['name']); ?>',
         '<?php echo htmlspecialchars($order['phone']); ?>')"
```

---

### 2️⃣ **관리자** - 회원 로그인으로 인증

**접근 방법**:
1. `http://localhost/member/login.php`에서 로그인
   - 아이디: `admin`
   - 비밀번호: `du701018`
2. 로그인 후 `http://localhost/sub/checkboard.php` 접근

**인증 방식**:
- 로그인 시 세션에 관리자 플래그 설정
- JavaScript에서 `isAdmin` 변수 확인 (checkboard.php 약 350번 라인)
- **관리자는 비밀번호 입력 없이 바로 팝업 열기**

**코드 위치**: `/var/www/html/sub/checkboard.php` (42-50번 라인)
```php
// 관리자 로그인 체크
$is_admin = false;
if (isset($_SESSION['user_level']) && $_SESSION['user_level'] == '1') {
    $is_admin = true;
} elseif (isset($_SESSION['username']) && $_SESSION['username'] == 'admin') {
    $is_admin = true;
} elseif (isset($_SESSION['level']) && $_SESSION['level'] == '1') {
    $is_admin = true;
}
```

**JavaScript 로직** (checkboard.php 약 370번 라인):
```javascript
const isAdmin = <?php echo $is_admin ? 'true' : 'false'; ?>;

function showPasswordModal(orderNo, orderName, orderPhone) {
    // 관리자는 비밀번호 입력 없이 바로 팝업 열기
    if (isAdmin) {
        openOrderPopup(orderNo);
        return;
    }

    // 일반 고객은 비밀번호 모달 표시
    document.getElementById('passwordModal').style.display = 'flex';
}
```

---

## 🎭 혼란의 원인

교정보기 페이지가:
1. ✅ **공개 페이지** (로그인 없이 접근 가능)
2. ✅ **전화번호로 주문 확인** (일반 고객)
3. ✅ **관리자 로그인으로 전체 주문 확인** (관리자)

**두 가지 목적**을 하나의 페이지에서 처리하기 때문입니다.

---

## 📊 비교표

| 구분 | 일반 고객 | 관리자 |
|-----|----------|--------|
| **로그인 필요** | ❌ 불필요 | ✅ 필요 (`/member/login.php`) |
| **인증 방법** | 전화번호 뒷자리 4자리 | 회원 로그인 (admin/du701018) |
| **확인 가능 주문** | 본인 주문만 (전화번호 일치) | 전체 주문 |
| **비밀번호 입력** | ✅ 매번 입력 필요 | ❌ 입력 불필요 (자동 통과) |

---

## 🎯 결론

**"관리자 로그인"** 이라고 했을 때:

1. **상품관리 시스템** (`/admin/MlangPrintAuto/login.php`)
   - 하드코딩: `admin` / `admin123`
   - 목적: 가격 테이블, 상품 설정 관리

2. **교정보기 관리자 모드** (`/member/login.php` 후 `/sub/checkboard.php`)
   - 데이터베이스: `admin` / `du701018`
   - 목적: 모든 고객 주문의 교정 이미지 확인

**두 개는 서로 다른 시스템이지만, 둘 다 "관리자"라는 이름을 사용해서 혼란스럽습니다!**

---

## 💡 권장사항

혼란을 줄이기 위해:
1. 상품관리 시스템 → "관리자 로그인"
2. 교정보기 관리자 모드 → "직원 로그인" 또는 "전체 주문 보기"

로 명칭을 구분하는 것이 좋습니다.
