# 금액고치기 - 큰 글자 금액 표시 수정 가이드

## 📋 개요
견적 페이지에서 큰 글자로 표시되는 금액을 **"부가세 포함 총액"**에서 **"인쇄비 + 디자인비 합계"**로 변경하는 방법

## 🎯 수정 목표
- **이전**: VAT 포함 총액이 큰 금액으로 표시
- **현재**: 인쇄비 + 디자인비 합계가 큰 금액으로 표시
- **결과**: 사용자가 실제 작업 비용을 한눈에 파악 가능

## 🔧 적용 방법

### 1. JavaScript 파일에서 수정할 함수

#### A. `updatePriceDisplay` 함수 수정
**파일 위치**: `js/[제품명]-compact.js` 또는 해당 제품의 JavaScript 파일

**기존 코드**:
```javascript
if (priceAmount) {
    priceAmount.textContent = priceData.formatted.vat_price;
}
```

**수정된 코드**:
```javascript
// 인쇄비 + 디자인비 합계를 큰 금액으로 표시
if (priceAmount) {
    // API에서 이미 계산된 total_price 사용
    const totalPrice = priceData.total_price || 0;
    
    priceAmount.textContent = formatNumber(totalPrice) + '원';
    console.log('💰 큰 금액 표시 (인쇄비+디자인비):', totalPrice + '원');
}
```

#### B. 초기 계산 함수에서도 수정 (있는 경우)
**함수명**: `performInitialCalculation` 또는 `calculateInitialPrice`

**기존 코드**:
```javascript
if (priceAmount) {
    priceAmount.textContent = formatNumber(response.data.final_price) + '원';
}
```

**수정된 코드**:
```javascript
// 초기 계산에서도 큰 금액 수정 (인쇄비 + 디자인비)
if (priceAmount) {
    const totalPrice = response.data.total_price || 0;
    priceAmount.textContent = formatNumber(totalPrice) + '원';
    console.log('💰 초기 큰 금액 표시 (인쇄비+디자인비):', totalPrice + '원');
}
```

### 2. 백엔드 API에서 확인할 사항

#### A. 가격 계산 API 응답 구조 확인
**파일**: `calculate_price_ajax.php` 또는 해당 제품의 가격 계산 파일

**필요한 응답 데이터**:
```php
$price_data = [
    'base_price' => $base_price,        // 인쇄비 (숫자)
    'design_price' => $design_price,    // 디자인비 (숫자)
    'total_price' => $total_price,      // 인쇄비 + 디자인비 합계 ⭐
    'vat_price' => $vat_price,          // 부가세 포함 총액
    'formatted' => [
        'base_price' => number_format($base_price) . '원',
        'design_price' => number_format($design_price) . '원',
        'total_price' => number_format($total_price) . '원',     // ⭐ 핵심
        'vat_price' => number_format($vat_price) . '원'
    ]
];
```

#### B. API 계산 로직 예시
```php
// 가격 계산
$base_price = intval($row['money']);                           // 인쇄비
$design_price = ($ordertype === 'total') ? intval($row['DesignMoney']) : 0;  // 디자인비
$total_price = $base_price + $design_price;                   // ⭐ 합계
$vat_price = intval($total_price * 1.1);                      // 부가세 포함
```

### 3. HTML에서 확인할 요소

#### 큰 금액 표시 요소
```html
<div class="price-amount" id="priceAmount">0원</div>
```

#### 세부 내역 표시 요소
```html
<div class="price-details" id="priceDetails">
    인쇄만: XX원<br>
    디자인비: XX원<br>
    <strong>부가세 포함: XX원</strong>
</div>
```

## 📂 적용 대상 제품 페이지

### 현재 적용 완료
- ✅ **양식지** (`MlangPrintAuto/NcrFlambeau/`)

### 향후 적용 가능
- 📋 **명함** (`MlangPrintAuto/NameCard/`)
- 📋 **전단지** (`MlangPrintAuto/inserted/`)
- 📋 **스티커** (`MlangPrintAuto/shop/`)
- 📋 **봉투** (`MlangPrintAuto/envelope/`)
- 📋 **포스터** (`MlangPrintAuto/LittlePrint/`)
- 📋 **카탈로그** (`MlangPrintAuto/cadarok/`)
- 📋 **상품권** (`MlangPrintAuto/MerchandiseBond/`)
- 📋 **자석스티커** (`MlangPrintAuto/msticker/`)

## 🔍 디버깅 및 확인 방법

### 1. 브라우저 콘솔 확인
```javascript
// 수정 후 콘솔에 다음 메시지가 표시되어야 함
💰 큰 금액 표시 (인쇄비+디자인비): 48000원
```

### 2. API 응답 확인
```javascript
// 개발자 도구 Network 탭에서 API 응답 확인
{
    "success": true,
    "data": {
        "base_price": 48000,
        "design_price": 0,
        "total_price": 48000,    // ⭐ 이 값이 큰 금액으로 표시됨
        "vat_price": 52800,
        "formatted": {
            "total_price": "48,000원"
        }
    }
}
```

### 3. 화면 표시 확인
```
🟢 큰 금액: 48,000원 (인쇄비 + 디자인비)
└── 세부 내역:
    ├── 인쇄만: 48,000원  
    ├── 디자인비: 0원
    └── 부가세 포함: 52,800원
```

## ⚠️ 주의 사항

### 1. formatNumber 함수 확인
```javascript
// 숫자 포맷팅 함수가 있는지 확인
function formatNumber(number) {
    return new Intl.NumberFormat('ko-KR').format(number);
}
```

### 2. API 응답 구조 차이
각 제품마다 API 응답 구조가 다를 수 있으므로:
- `total_price` 필드명 확인
- `base_price` + `design_price` 직접 계산 필요 여부 확인

### 3. 백엔드 수정 필요한 경우
만약 API에서 `total_price`를 제공하지 않는다면:
```javascript
// JavaScript에서 직접 계산
const basePrice = priceData.base_price || 0;
const designPrice = priceData.design_price || 0;
const totalPrice = basePrice + designPrice;
priceAmount.textContent = formatNumber(totalPrice) + '원';
```

## 📝 적용 체크리스트

- [ ] 1. `updatePriceDisplay` 함수에서 큰 금액 수정
- [ ] 2. 초기 계산 함수에서도 동일 수정
- [ ] 3. API 응답에 `total_price` 필드 포함 확인
- [ ] 4. 브라우저 콘솔에서 로그 확인
- [ ] 5. 실제 화면에서 금액 표시 확인
- [ ] 6. 옵션 변경 시 실시간 업데이트 확인

---

**작성일**: 2025년 8월 22일  
**최종 테스트**: 양식지 페이지에서 정상 작동 확인  
**개발자**: AI Assistant (Claude)