# 구현 계획

- [x] 1. Ajax API 엔드포인트 구조 설정


  - Ajax 요청을 처리할 디렉토리 구조 생성 (MlangPrintAuto/envelope/ajax/)
  - 공통 응답 형식과 에러 처리를 위한 기본 클래스 구현
  - 데이터베이스 연결과 입력 검증을 위한 유틸리티 함수 작성
  - envelope 시스템에 특화된 설정 파일 생성
  - _요구사항: 3.1, 3.2, 3.3_



- [ ] 2. 종류 조회 API 구현




  - get_envelope_types.php 파일 생성하여 구분 기반 종류 조회 기능 구현
  - BigNo 관계를 이용한 데이터베이스 쿼리 작성 (envelope 테이블 특화)
  - JSON 형태로 종류 목록 반환하는 로직 구현


  - 입력값 검증 및 SQL 인젝션 방지를 위한 Prepared Statement 사용
  - _요구사항: 1.1, 1.2, 3.1, 3.2_




- [ ] 3. 가격 계산 API 구현

  - calculate_envelope_price.php 파일 생성하여 실시간 가격 계산 기능 구현

  - 기존 price_cal.php의 로직을 Ajax 방식으로 변환
  - 모든 드롭다운 선택값을 받아 mlangprintauto_envelope 테이블에서 가격 조회


  - 인쇄비, 디자인비, 총액 계산 로직 구현

  - _요구사항: 2.1, 2.2, 2.3, 3.1, 3.2_

- [ ] 4. 프론트엔드 EnvelopeDropdownManager 클래스 구현

  - JavaScript 클래스로 envelope 전용 드롭다운 관리 기능 구현
  - Ajax 요청 처리 및 응답 데이터로 드롭다운 옵션 업데이트 기능
  - 로딩 상태 표시 및 에러 처리 기능 구현
  - 2단계 드롭다운 연쇄 업데이트 로직 구현 (구분 → 종류)
  - _요구사항: 1.1, 1.2, 1.3, 4.1_

- [ ] 5. 로딩 인디케이터 및 에러 처리 구현
  - LoadingIndicator 클래스로 Ajax 요청 중 스피너 표시 기능 구현
  - ErrorHandler 클래스로 네트워크 에러, 서버 에러 처리 기능 구현
  - 사용자 친화적인 에러 메시지 표시 및 이전 상태 복원 기능
  - 타임아웃 처리 및 재시도 옵션 제공
  - _요구사항: 4.1, 4.2, 4.3, 1.3_

- [ ] 6. 기존 envelope/index.php에 Ajax 기능 통합
  - 기존 드롭다운에 Ajax 이벤트 핸들러 추가
  - change_Field 함수를 Ajax 방식으로 대체하는 새로운 함수 구현
  - 기존 calc_ok 함수와 Ajax 가격 계산 기능 연동
  - 기존 폼 제출 기능과 충돌하지 않도록 호환성 보장
  - _요구사항: 1.1, 2.1, 5.1, 5.2_

- [ ] 7. 실시간 가격 계산 자동화 구현
  - 모든 필수 드롭다운 선택 완료 시 자동 가격 계산 트리거 기능
  - 기존 iframe 방식 대신 Ajax 방식으로 가격 계산 결과 표시
  - 필수값 누락 시 가격 필드 초기화 및 안내 메시지 표시
  - 계산 결과를 기존 폼 필드에 자동 입력하여 주문 기능과 연동
  - _요구사항: 2.1, 2.2, 2.3_

- [ ] 8. 단위 테스트 작성
  - 각 Ajax API 엔드포인트에 대한 단위 테스트 작성
  - JavaScript 함수들의 단위 테스트 작성
  - 데이터베이스 쿼리 결과 검증 테스트
  - 에러 시나리오에 대한 테스트 케이스 작성
  - _요구사항: 모든 요구사항의 검증_

- [ ] 9. 통합 테스트 및 호환성 검증
  - 전체 드롭다운 연동 플로우 테스트
  - 기존 기능과의 호환성 테스트 (파일 업로드, 폼 제출)
  - 다양한 브라우저에서의 동작 테스트
  - 네트워크 지연 및 에러 상황 시뮬레이션 테스트
  - _요구사항: 5.1, 5.2, 5.3, 4.2, 4.3_

- [ ] 10. 성능 최적화 및 배포 준비
  - Ajax 요청 캐싱 및 디바운싱 구현
  - 데이터베이스 쿼리 최적화
  - 프로덕션 환경 배포를 위한 최종 검증
  - 사용자 가이드 및 문서화 작성
  - _요구사항: 모든 요구사항의 성능 최적화_