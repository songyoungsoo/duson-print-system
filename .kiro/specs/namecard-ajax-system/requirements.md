# 명함 자동견적 시스템 요구사항 문서

## 소개

명함 자동견적 시스템은 사용자가 명함 종류, 용지, 수량, 인쇄면을 선택하면 실시간으로 가격을 계산해주는 웹 기반 AJAX 시스템입니다. 이 시스템은 연쇄적 옵션 업데이트와 비동기 가격 계산을 통해 사용자에게 즉각적인 피드백을 제공합니다.

## 요구사항

### 요구사항 1: 초기 페이지 로드 및 기본 옵션 표시

**사용자 스토리:** 사용자로서, 명함 주문 페이지에 접속하면 기본 명함 종류와 해당하는 용지 옵션들이 미리 로드되어 있기를 원한다.

#### 승인 기준
1. WHEN 사용자가 명함 주문 페이지에 접속하면 THEN 시스템은 MlangPrintAuto_transactionCate 테이블에서 BigNo='0'인 명함 종류들을 조회하여 드롭다운에 표시해야 한다
2. WHEN 페이지가 로드되면 THEN 시스템은 첫 번째 명함 종류에 해당하는 용지 옵션들을 자동으로 로드하여 표시해야 한다
3. WHEN 초기 데이터 로딩이 완료되면 THEN 사용자는 명함 종류와 용지 종류를 선택할 수 있어야 한다

### 요구사항 2: 연쇄적 옵션 업데이트 시스템

**사용자 스토리:** 사용자로서, 명함 종류를 변경하면 관련된 모든 하위 옵션들(용지, 수량, 인쇄면)이 자동으로 업데이트되기를 원한다.

#### 승인 기준
1. WHEN 사용자가 명함 종류를 변경하면 THEN 시스템은 change_NameCard_Field 함수를 호출하여 용지 옵션을 초기화하고 새로운 옵션들을 AJAX로 로드해야 한다
2. WHEN 용지 옵션 로딩이 완료되면 THEN 시스템은 자동으로 updateNameCardQuantities 함수를 호출하여 수량 옵션을 업데이트해야 한다
3. WHEN 수량 옵션 로딩이 완료되면 THEN 시스템은 자동으로 updateNameCardSides 함수를 호출하여 인쇄면 옵션을 업데이트해야 한다
4. WHEN 모든 옵션 업데이트가 완료되면 THEN 시스템은 자동으로 가격 계산을 실행해야 한다

### 요구사항 3: AJAX 기반 비동기 데이터 로딩

**사용자 스토리:** 사용자로서, 옵션을 변경할 때 페이지 새로고침 없이 즉시 관련 옵션들이 업데이트되기를 원한다.

#### 승인 기준
1. WHEN 시스템이 용지 옵션을 요청할 때 THEN get_namecard_types.php를 AJAX로 호출하여 JSON 형태의 응답을 받아야 한다
2. WHEN 시스템이 수량 옵션을 요청할 때 THEN get_namecard_quantities.php를 AJAX로 호출하여 해당 명함+용지 조합의 가능한 수량들을 받아야 한다
3. WHEN 시스템이 인쇄면 옵션을 요청할 때 THEN get_namecard_sides.php를 AJAX로 호출하여 단면/양면 옵션을 받아야 한다
4. WHEN AJAX 요청이 실패하면 THEN 시스템은 적절한 에러 메시지를 콘솔에 출력하고 사용자에게 알려야 한다

### 요구사항 4: 실시간 가격 계산 시스템

**사용자 스토리:** 사용자로서, 모든 옵션을 선택하면 즉시 인쇄비, 편집비, 총 금액이 계산되어 표시되기를 원한다.

#### 승인 기준
1. WHEN 모든 필수 옵션(명함종류, 용지, 수량, 인쇄면, 주문방법)이 선택되면 THEN 시스템은 nc_calc_ok 함수를 자동으로 호출해야 한다
2. WHEN 가격 계산 요청이 전송되면 THEN namecard_price_ajax.php가 MlangPrintAuto_NameCard 테이블에서 해당 조합의 가격 정보를 조회해야 한다
3. WHEN 가격 계산이 완료되면 THEN 시스템은 인쇄비, 편집비, 부가세, 총액을 각각의 입력 필드에 표시해야 한다
4. WHEN 해당 조합의 가격 정보가 없으면 THEN 시스템은 "해당 명함 조건의 가격 정보가 없습니다" 메시지를 표시해야 한다

### 요구사항 5: 데이터베이스 구조 및 관계

**사용자 스토리:** 시스템 관리자로서, 명함 옵션과 가격 정보가 체계적으로 관리되어 데이터 정합성이 보장되기를 원한다.

#### 승인 기준
1. WHEN 시스템이 옵션 이름을 조회할 때 THEN MlangPrintAuto_transactionCate 테이블을 사용하여 계층적 구조로 관리해야 한다
2. WHEN 시스템이 가격 정보를 조회할 때 THEN MlangPrintAuto_NameCard 테이블을 사용하여 실제 조합별 가격을 관리해야 한다
3. WHEN 옵션 조합이 변경되면 THEN 시스템은 해당 조합이 실제로 존재하는지 확인하고 존재하는 옵션만 표시해야 한다
4. WHEN 데이터베이스 조회가 실행되면 THEN 모든 쿼리는 SQL 인젝션 방지를 위해 적절히 이스케이프되어야 한다

### 요구사항 6: 사용자 경험 및 인터페이스

**사용자 스토리:** 사용자로서, 직관적이고 반응성이 좋은 인터페이스를 통해 쉽게 명함을 주문하고 싶다.

#### 승인 기준
1. WHEN 사용자가 옵션을 변경할 때 THEN 시스템은 0.1초 이내에 관련 옵션들을 업데이트해야 한다
2. WHEN 가격 계산이 진행될 때 THEN 사용자는 다른 옵션을 계속 변경할 수 있어야 한다 (비동기 처리)
3. WHEN 필수 옵션이 선택되지 않았을 때 THEN 시스템은 주문 버튼 클릭 시 적절한 안내 메시지를 표시해야 한다
4. WHEN 시스템 오류가 발생할 때 THEN 사용자에게 이해하기 쉬운 에러 메시지를 표시해야 한다

### 요구사항 7: 주문 데이터 처리 및 검증

**사용자 스토리:** 사용자로서, 모든 옵션을 선택하고 주문하기 버튼을 클릭하면 정확한 주문 정보가 전송되기를 원한다.

#### 승인 기준
1. WHEN 사용자가 주문하기 버튼을 클릭하면 THEN 시스템은 CheckTotal 함수를 통해 모든 필수 정보가 입력되었는지 검증해야 한다
2. WHEN 검증이 완료되면 THEN 시스템은 선택된 옵션의 텍스트 값과 ID 값을 모두 숨겨진 필드에 저장해야 한다
3. WHEN 폼이 제출되면 THEN 시스템은 OnlineOrder.php로 모든 주문 정보를 POST 방식으로 전송해야 한다
4. WHEN 파일 첨부가 있을 때 THEN 시스템은 파일 정보도 함께 주문 데이터에 포함해야 한다