<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>AJAX ê°€ê²© ê³„ì‚° í…ŒìŠ¤íŠ¸</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h2>ğŸ§ª AJAX ê°€ê²© ê³„ì‚° í…ŒìŠ¤íŠ¸</h2>
    
    <form id="testForm">
        <table border="1" style="border-collapse: collapse;">
            <tr>
                <td>ì¬ì§ˆ:</td>
                <td>
                    <select name="jong" id="jong">
                        <option value="jil ì•„íŠ¸ìœ ê´‘ì½”íŒ…">jil ì•„íŠ¸ìœ ê´‘ì½”íŒ…</option>
                        <option value="jil ì•„íŠ¸ë¬´ê´‘ì½”íŒ…">jil ì•„íŠ¸ë¬´ê´‘ì½”íŒ…</option>
                        <option value="jka ê°•ì ‘ì•„íŠ¸ìœ ê´‘ì½”íŒ…">jka ê°•ì ‘ì•„íŠ¸ìœ ê´‘ì½”íŒ…</option>
                        <option value="jsp íˆ¬ëª…ìŠ¤í‹°ì»¤">jsp íˆ¬ëª…ìŠ¤í‹°ì»¤</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>ê°€ë¡œ(mm):</td>
                <td><input type="number" name="garo" id="garo" value="100"></td>
            </tr>
            <tr>
                <td>ì„¸ë¡œ(mm):</td>
                <td><input type="number" name="sero" id="sero" value="150"></td>
            </tr>
            <tr>
                <td>ìˆ˜ëŸ‰:</td>
                <td><input type="number" name="mesu" id="mesu" value="1000"></td>
            </tr>
            <tr>
                <td>ìœ í˜•:</td>
                <td><input type="number" name="uhyung" id="uhyung" value="0"></td>
            </tr>
            <tr>
                <td>ë„ë¬´ì†¡:</td>
                <td>
                    <select name="domusong" id="domusong">
                        <option value="00000 ì‚¬ê°">00000 ì‚¬ê°</option>
                        <option value="08000 ì›í˜•">08000 ì›í˜•</option>
                        <option value="12000 íƒ€ì›í˜•">12000 íƒ€ì›í˜•</option>
                    </select>
                </td>
            </tr>
        </table>
        <br>
        <button type="button" onclick="calculatePrice()">ê°€ê²© ê³„ì‚°</button>
    </form>
    
    <div id="result" style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 5px; display: none;">
        <h3>ê³„ì‚° ê²°ê³¼:</h3>
        <div id="price-display"></div>
    </div>
    
    <div id="error" style="margin-top: 20px; padding: 10px; background: #ffebee; border-radius: 5px; color: red; display: none;">
        <h3>ì˜¤ë¥˜:</h3>
        <div id="error-message"></div>
    </div>

    <script>
    function calculatePrice() {
        const formData = new FormData();
        formData.append('action', 'calculate');
        formData.append('jong', document.getElementById('jong').value);
        formData.append('garo', document.getElementById('garo').value);
        formData.append('sero', document.getElementById('sero').value);
        formData.append('mesu', document.getElementById('mesu').value);
        formData.append('uhyung', document.getElementById('uhyung').value);
        formData.append('domusong', document.getElementById('domusong').value);
        
        console.log('ì „ì†¡ ë°ì´í„°:', Object.fromEntries(formData));
        
        fetch('calculate_price.php', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            console.log('ì‘ë‹µ ë°ì´í„°:', data);
            
            document.getElementById('error').style.display = 'none';
            
            if (data.success) {
                document.getElementById('price-display').innerHTML = 
                    '<strong>ê°€ê²©: ' + data.price + 'ì›</strong><br>' +
                    '<strong>VAT í¬í•¨: ' + data.price_vat + 'ì›</strong>';
                document.getElementById('result').style.display = 'block';
            } else {
                document.getElementById('error-message').textContent = data.message;
                document.getElementById('error').style.display = 'block';
                document.getElementById('result').style.display = 'none';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('error-message').textContent = 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            document.getElementById('error').style.display = 'block';
            document.getElementById('result').style.display = 'none';
        });
    }
    </script>
</body>
</html>