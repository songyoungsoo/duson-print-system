<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ê°„ë‹¨í•œ ì¥ë°”êµ¬ë‹ˆ í…ŒìŠ¤íŠ¸</title>
</head>
<body>
    <h2>ğŸ§ª ê°„ë‹¨í•œ ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€ í…ŒìŠ¤íŠ¸</h2>
    
    <form id="testForm">
        <table border="1" style="border-collapse: collapse;">
            <tr>
                <td>ì¬ì§ˆ:</td>
                <td>
                    <select name="jong">
                        <option value="jil ì•„íŠ¸ìœ ê´‘ì½”íŒ…">jil ì•„íŠ¸ìœ ê´‘ì½”íŒ…</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>ê°€ë¡œ(mm):</td>
                <td><input type="number" name="garo" value="100"></td>
            </tr>
            <tr>
                <td>ì„¸ë¡œ(mm):</td>
                <td><input type="number" name="sero" value="150"></td>
            </tr>
            <tr>
                <td>ìˆ˜ëŸ‰:</td>
                <td><input type="number" name="mesu" value="1000"></td>
            </tr>
            <tr>
                <td>ìœ í˜•:</td>
                <td><input type="number" name="uhyung" value="0"></td>
            </tr>
            <tr>
                <td>ë„ë¬´ì†¡:</td>
                <td>
                    <select name="domusong">
                        <option value="08000 ì›í˜•">08000 ì›í˜•</option>
                    </select>
                </td>
            </tr>
        </table>
        <br>
        <button type="button" onclick="testAddToBasket()">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
    </form>
    
    <div id="result" style="margin-top: 20px; padding: 10px; background: #e8f5e8; border-radius: 5px; display: none;">
        <h3>ì„±ê³µ!</h3>
        <div id="result-content"></div>
    </div>
    
    <div id="error" style="margin-top: 20px; padding: 10px; background: #ffebee; border-radius: 5px; color: red; display: none;">
        <h3>ì˜¤ë¥˜!</h3>
        <div id="error-content"></div>
    </div>

    <script>
    function testAddToBasket() {
        const form = document.getElementById('testForm');
        const formData = new FormData(form);
        
        // action íŒŒë¼ë¯¸í„° ì¶”ê°€
        formData.set('action', 'add_to_basket');
        formData.set('no', '');
        
        console.log('ì „ì†¡ ë°ì´í„°:');
        for (let [key, value] of formData.entries()) {
            console.log(key + ': ' + value);
        }
        
        fetch('add_to_basket_simple.php', {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(text => {
            console.log('ì„œë²„ ì‘ë‹µ:', text);
            
            try {
                const data = JSON.parse(text);
                
                document.getElementById('error').style.display = 'none';
                document.getElementById('result').style.display = 'none';
                
                if (data.success) {
                    document.getElementById('result-content').innerHTML = 
                        data.message + '<br>ê°€ê²©: ' + data.price + 'ì›<br>VAT í¬í•¨: ' + data.price_vat + 'ì›';
                    document.getElementById('result').style.display = 'block';
                } else {
                    document.getElementById('error-content').innerHTML = data.message;
                    document.getElementById('error').style.display = 'block';
                }
            } catch (e) {
                document.getElementById('error-content').innerHTML = 
                    'JSON íŒŒì‹± ì˜¤ë¥˜<br>ì„œë²„ ì‘ë‹µ: ' + text;
                document.getElementById('error').style.display = 'block';
            }
        })
        .catch(error => {
            console.error('ì˜¤ë¥˜:', error);
            document.getElementById('error-content').innerHTML = 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ' + error.message;
            document.getElementById('error').style.display = 'block';
        });
    }
    </script>
</body>
</html>