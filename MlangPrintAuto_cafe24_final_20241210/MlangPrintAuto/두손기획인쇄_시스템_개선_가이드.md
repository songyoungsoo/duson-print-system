# 두손기획인쇄 시스템 - 품목별 컴팩트 버전 개발 가이드

## 📋 개요

이 문서는 두손기획인쇄 시스템의 각 품목을 명함 시스템처럼 현대적인 컴팩트 버전으로 개선하기 위한 종합 가이드입니다. 명함 시스템(`MlangPrintAuto/NameCard/`)의 성공 사례를 기반으로 작성되었습니다.

## 🎯 명함 주문 프로세스 분석 (성공 모델)

### 1. 사용자 접근 경로
```
메인 페이지 → 명함 선택 → 컴팩트 주문 페이지 → 옵션 선택 → 실시간 가격 계산 → 파일 업로드 → 장바구니/주문
```

### 2. 기술적 아키텍처
```
C:\xampp\htdocs\MlangPrintAuto\NameCard\
├── index.php                    # 메인 컴팩트 인터페이스 (★ 핵심)
├── add_to_basket.php           # 장바구니 처리 백엔드
├── calculate_price_ajax.php    # 실시간 가격 계산 API
├── get_namecard_images.php     # 갤러리 이미지 데이터 API
├── get_paper_types.php         # 동적 옵션 로딩 API
├── get_quantities.php          # 수량 옵션 API
├── PROJECT_SUCCESS_REPORT.md   # 개발 성과 보고서
└── js/, css/ 폴더들           # 전용 스타일 및 스크립트
```

### 3. 핵심 성공 요소

#### A. 컴팩트 UI 설계
- **2단 그리드 레이아웃**: 500px 갤러리 + 나머지 계산기
- **단일 페이지 완결**: 모든 과정을 하나의 화면에서 처리
- **실시간 반응**: 옵션 변경 시 즉시 가격 업데이트

#### B. 고급 이미지 갤러리
- **적응형 이미지 분석**: 자동으로 이미지 크기 감지
- **부드러운 애니메이션**: 0.08 lerp 계수로 초부드러운 확대/축소
- **스마트 확대 시스템**: 작은 이미지 1.4배, 큰 이미지 1.6배

#### C. 실시간 가격 계산
- **계층적 옵션 구조**: 종류 → 재질 → 수량 순차 로딩
- **자동 계산**: 모든 옵션 선택 시 자동으로 가격 표시
- **기본값 설정**: 일반명함(쿠폰) 우선 선택

#### D. 파일 업로드 모달
- **드래그 앤 드롭**: HTML5 API 활용
- **파일 유효성 검증**: 확장자 및 용량 제한
- **실시간 파일 목록**: 동적 파일 추가/삭제

## 🏗️ 통일된 개선 기준

### 1. 필수 구현 요소 (100% 적용)

#### A. 공통 파일 구조
```php
// 모든 index.php 파일의 표준 구조
<?php
// 공통 인증 및 설정
include "../../includes/auth.php";
include "../../includes/functions.php";
include "../../db.php";

// 데이터베이스 연결 및 설정
check_db_connection($db);
mysqli_set_charset($db, "utf8");

// 로그 정보 및 페이지 설정
$log_info = generateLogInfo();
$page_title = generate_page_title("[품목명] 견적안내 컴팩트 - 프리미엄");

// 기본값 설정 (각 품목별 맞춤)
$default_values = [
    // 품목별 기본값 배열
];
?>
```

#### B. HTML 구조 템플릿
```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?php echo safe_html($page_title); ?></title>
    
    <!-- 공통 헤더 포함 -->
    <?php include "../../includes/header.php"; ?>
    
    <!-- 품목 전용 CSS -->
    <link rel="stylesheet" href="../../css/[품목명]-compact.css">
    <link rel="stylesheet" href="../../css/gallery-common.css">
    
    <!-- 고급 JavaScript 라이브러리 -->
    <script src="../../includes/js/GalleryLightbox.js"></script>
    <script src="../../js/[품목명].js" defer></script>
</head>
<body>
    <?php include "../../includes/nav.php"; ?>
    
    <div class="compact-container">
        <div class="page-title">
            <h1>[이모지] [품목명] 견적안내</h1>
            <p>컴팩트 프리미엄 버전</p>
        </div>

        <!-- 2단 그리드 레이아웃 -->
        <div class="main-content">
            <!-- 좌측: 갤러리 섹션 -->
            <div class="gallery-section">
                <div class="gallery-title">🖼️ [품목명] 샘플 갤러리</div>
                <div id="[품목명]Gallery">
                    <div class="loading">🖼️ 갤러리 로딩 중...</div>
                </div>
            </div>

            <!-- 우측: 계산기 섹션 -->
            <div class="calculator-section">
                <div class="calculator-header">
                    <h3>💰 실시간 견적 계산기</h3>
                </div>
                
                <form id="[품목명]Form">
                    <!-- 옵션 선택 그리드 -->
                    <div class="options-grid">
                        <!-- 각 품목별 맞춤 옵션들 -->
                    </div>
                    
                    <!-- 실시간 가격 표시 -->
                    <div class="price-display" id="priceDisplay">
                        <div class="price-label">견적 금액</div>
                        <div class="price-amount" id="priceAmount">견적 계산 필요</div>
                        <div class="price-details" id="priceDetails">
                            모든 옵션을 선택하면 자동으로 계산됩니다
                        </div>
                    </div>
                    
                    <!-- 업로드 및 주문 버튼 -->
                    <div class="upload-order-button" id="uploadOrderButton" style="display: none;">
                        <button type="button" class="btn-upload-order" onclick="openUploadModal()">
                            📎 파일 업로드 및 주문하기
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 파일 업로드 모달 -->
    [표준 업로드 모달 구조]
    
    <?php include "../../includes/login_modal.php"; ?>
    <?php include "../../includes/footer.php"; ?>
</body>
</html>
```

### 2. 백엔드 API 파일들 (각 품목별 구현)

#### A. calculate_price_ajax.php 템플릿
```php
<?php
require_once __DIR__ . '/../../includes/safe_json_response.php';
header('Content-Type: application/json; charset=utf-8');

include "../../includes/functions.php";
include "../../db.php";

// 품목별 가격 계산 로직
$price_data = calculate[품목명]Price($db, $_POST);

if ($price_data) {
    safe_json_response(true, $price_data, '가격 계산 완료');
} else {
    safe_json_response(false, null, '가격 계산 오류');
}
?>
```

#### B. add_to_basket.php 템플릿
```php
<?php
require_once __DIR__ . '/../../includes/safe_json_response.php';
header('Content-Type: application/json; charset=utf-8');

session_start();
include "../../includes/functions.php";
include "../../db.php";

// 입력값 검증
$required_fields = ['field1', 'field2', 'field3']; // 품목별 필수 필드
foreach ($required_fields as $field) {
    if (empty($_POST[$field])) {
        safe_json_response(false, null, "필수 정보가 누락되었습니다: $field");
    }
}

// 장바구니 추가 로직
$insert_query = "INSERT INTO shop_temp (session_id, product_type, [품목별_필드들]) VALUES (...)";
// 실행 및 응답
?>
```

### 3. 프론트엔드 JavaScript 템플릿

#### A. [품목명].js 구조
```javascript
// 전역 변수
let currentPriceData = null;
let uploadedFiles = [];

// 초기화 함수
document.addEventListener('DOMContentLoaded', function() {
    initializeForm();
    initializeGallery();
    initializePriceCalculation();
});

// 폼 초기화
function initializeForm() {
    // 기본값 설정
    // 이벤트 리스너 등록
    // 동적 옵션 로딩
}

// 갤러리 초기화
function initializeGallery() {
    // 갤러리 이미지 로드
    // 확대 기능 구현
    // 애니메이션 설정
}

// 가격 계산
function calculatePrice(auto = false) {
    // AJAX 호출
    // 가격 표시 업데이트
    // 버튼 상태 변경
}

// 모달 관리
function openUploadModal() {
    // 모달 열기
    // 파일 업로드 초기화
}

function addToBasketFromModal() {
    // 장바구니 추가
    // 파일 업로드 처리
}
```

## 📊 품목별 맞춤 개발 가이드

### 1. 🏷️ 스티커 (sticker/) - 수식 기반 계산

#### 특화 요소
- **수식 기반 가격 계산**: 테이블 조회가 아닌 JavaScript 수식
- **다양한 재질**: 아트지유광, 아트지무광, 투명스티커, 홀로그램 등
- **사용자 정의 크기**: 가로(garo) x 세로(sero) 직접 입력
- **모양 옵션**: 사각형, 원형, 타원형, 별모양 등

#### 구현 체크리스트
- [ ] 기존 `shop/view_modern.php`의 수식 계산 로직 이식
- [ ] 크기 입력 필드 (10mm~1000mm 범위)
- [ ] 모양 선택 드롭다운
- [ ] 실시간 수식 계산 (shop_d1~d4 테이블 참조)
- [ ] 수량별 할인 적용 (500매~30,000매)

```javascript
// 스티커 전용 가격 계산 함수
function calculateStickerPrice() {
    const jong = document.getElementById('jong').value;
    const garo = parseInt(document.getElementById('garo').value);
    const sero = parseInt(document.getElementById('sero').value);
    const mesu = parseInt(document.getElementById('mesu').value);
    const uhyung = document.getElementById('uhyung').value;
    
    // 기존 view_modern.php의 복잡한 수식 적용
    // 면적 계산, 재질별 단가, 수량 할인 등
}
```

### 2. 🧲 자석스티커 (msticker/) - 테이블 기반

#### 특화 요소
- **표준 크기 옵션**: 미리 정의된 크기 선택
- **자석 재질**: 일반 스티커와 다른 재질 옵션
- **테이블 기반 계산**: 명함과 유사한 구조

#### 구현 체크리스트
- [ ] 표준 크기 드롭다운 (데이터베이스 기반)
- [ ] 자석 재질별 가격 테이블 조회
- [ ] 수량별 가격 계산
- [ ] 기존 갤러리 이미지 활용

### 3. ✉️ 봉투 (envelope/) - 완성된 시스템

#### 현재 상태
- ✅ 이미 컴팩트 스타일로 개선 완료
- ✅ 표준 크기 + 사용자 정의 크기 지원
- ✅ 실시간 가격 계산 구현

#### 추가 개선 사항
- [ ] 갤러리 이미지 추가
- [ ] 파일 업로드 모달 통합
- [ ] 애니메이션 효과 추가

### 4. 📄 포스터 (LittlePrint/) - 전단지와 유사

#### 특화 요소
- **용지 종류**: 다양한 용지 옵션
- **크기 선택**: A4, A3, B4 등 표준 크기
- **인쇄면**: 단면/양면 선택

#### 구현 체크리스트
- [ ] 용지 종류 계층적 선택 (색상 → 용지 → 크기)
- [ ] 수량별 가격 테이블 조회
- [ ] 후가공 옵션 추가
- [ ] 대용량 파일 업로드 지원

### 5. 📚 카다록 (cadarok/) - 복합 제품

#### 특화 요소
- **복잡한 옵션**: 페이지 수, 제본 방식, 용지 등
- **다단계 선택**: 여러 단계의 옵션 선택
- **고가 제품**: 정확한 견적 필요

#### 구현 체크리스트
- [ ] 다단계 옵션 선택 UI
- [ ] 페이지 수 입력 필드
- [ ] 제본 방식별 가격 차등
- [ ] 상세 견적서 생성

### 6. 🎫 상품권 (MerchandiseBond/) - 동적 카테고리

#### 특화 요소
- **동적 드롭다운**: 구분 → 종류 → 후가공 순차 로딩
- **다양한 카테고리**: 상품권, 쿠폰, 티켓 등
- **보안 요소**: 특수 용지 및 보안 인쇄

#### 구현 체크리스트
- [ ] 계층적 카테고리 AJAX 로딩
- [ ] 특수 용지 옵션
- [ ] 보안 인쇄 선택지
- [ ] 수량별 대량 할인

### 7. 📋 양식지 (NcrFlambeau/) - 복사지 계산

#### 특화 요소
- **복사지 매수**: 2매, 3매, 4매 등
- **크기 선택**: A4, A5, B4 등
- **특수 인쇄**: 넘버링, 구멍뚫기 등

#### 구현 체크리스트
- [ ] 복사지 매수별 가격 계산
- [ ] 특수 옵션 추가 비용
- [ ] 넘버링 범위 입력
- [ ] 후가공 옵션 선택

## 🔧 개발 진행 순서

### Phase 1: 기반 작업 (1-2일)
1. **공통 CSS 파일 생성**: `css/[품목명]-compact.css`
2. **공통 JavaScript 템플릿**: `js/[품목명].js`
3. **데이터베이스 스키마 확인**: 필요시 컬럼 추가
4. **갤러리 이미지 준비**: 각 품목별 샘플 이미지

### Phase 2: 개별 품목 개발 (품목당 1-2일)
1. **스티커** (가장 복잡) → **자석스티커** (중간) → **나머지 품목들**
2. 각 품목별 index.php 컴팩트 버전 개발
3. 가격 계산 API 구현
4. 장바구니 연동 테스트

### Phase 3: 통합 및 최적화 (1일)
1. **네비게이션 메뉴 업데이트**: 컴팩트 버전 링크
2. **공통 기능 최적화**: 중복 코드 제거
3. **전체 시스템 테스트**: 모든 품목 주문 플로우 확인
4. **성능 최적화**: 이미지 압축, 코드 최적화

## 📝 개발자 체크리스트 템플릿

### 각 품목 개발 시 확인사항

#### 🎨 UI/UX 체크리스트
- [ ] 2단 그리드 레이아웃 (갤러리 + 계산기)
- [ ] 반응형 디자인 (768px 이하 1단 전환)
- [ ] 실시간 가격 표시
- [ ] 로딩 상태 표시
- [ ] 에러 메시지 처리
- [ ] 성공 알림
- [ ] 부드러운 애니메이션

#### 🔧 기능 체크리스트
- [ ] 옵션 선택 계층 구조
- [ ] 실시간 가격 계산
- [ ] 파일 업로드 (드래그앤드롭)
- [ ] 장바구니 추가
- [ ] 바로 주문하기
- [ ] 갤러리 확대 기능
- [ ] 모바일 터치 지원

#### 🗄️ 데이터베이스 체크리스트
- [ ] shop_temp 테이블 필드 추가
- [ ] 가격 계산용 테이블 확인
- [ ] 갤러리 이미지 데이터
- [ ] 옵션 카테고리 데이터
- [ ] 인덱스 최적화

#### 🛡️ 보안 체크리스트
- [ ] SQL 인젝션 방지 (prepared statements)
- [ ] XSS 방지 (htmlspecialchars)
- [ ] CSRF 토큰 확인
- [ ] 파일 업로드 검증
- [ ] 권한 확인

#### 🚀 성능 체크리스트
- [ ] AJAX 요청 최적화
- [ ] 이미지 지연 로딩
- [ ] CSS/JS 압축
- [ ] 캐시 활용
- [ ] 데이터베이스 쿼리 최적화

## 📈 예상 개발 일정

| 품목 | 복잡도 | 예상 시간 | 주요 이슈 |
|------|---------|------------|-----------|
| 스티커 | ★★★★★ | 2-3일 | 수식 계산, 다양한 옵션 |
| 자석스티커 | ★★★☆☆ | 1-2일 | 표준화된 구조 |
| 포스터 | ★★★☆☆ | 1-2일 | 전단지와 유사 |
| 카다록 | ★★★★☆ | 2일 | 복잡한 옵션 구조 |
| 상품권 | ★★★★☆ | 2일 | 동적 카테고리 |
| 양식지 | ★★★☆☆ | 1-2일 | 특수 옵션 |

**총 예상 기간**: 10-15일 (테스트 및 최적화 포함)

## 🎯 성공 지표

### 개발 완료 기준
1. **기능적 완성도**: 모든 주문 플로우 정상 작동
2. **UI 일관성**: 명함 시스템과 동일한 사용자 경험
3. **성능**: 3초 이내 페이지 로딩, 1초 이내 가격 계산
4. **오류율**: 0% 주문 오류, 0% 장바구니 오류
5. **반응형**: 모든 디바이스에서 정상 작동

### 비즈니스 목표
1. **사용자 만족도**: 직관적인 단일 페이지 주문
2. **전환율 개선**: 기존 대비 30% 향상 목표
3. **운영 효율성**: 자동화된 주문 처리
4. **브랜드 가치**: 프리미엄 사용자 경험

## 📞 지원 및 참고자료

### 참고 파일
- `MlangPrintAuto/NameCard/PROJECT_SUCCESS_REPORT.md` - 개발 성과 보고서
- `css/namecard-compact.css` - UI 스타일 참고
- `js/namecard.js` - JavaScript 구현 참고
- `includes/safe_json_response.php` - 안전한 JSON 응답 함수

### 개발 원칙
1. **명함 시스템 기준 준수**: 검증된 구조 활용
2. **점진적 개선**: 기능 우선, 완성도 향상
3. **사용자 중심**: 편의성과 직관성 최우선
4. **확장성 고려**: 미래 기능 추가 대비

---

*이 가이드는 두손기획인쇄 시스템의 전체적인 사용자 경험 향상을 목표로 작성되었습니다. 각 품목의 특성을 고려하되, 통일된 사용자 인터페이스를 통해 일관성 있는 서비스를 제공하는 것이 핵심 목표입니다.*

**최종 업데이트**: 2025년 8월 15일  
**문서 버전**: 1.0  
**작성자**: AI Assistant (Claude)