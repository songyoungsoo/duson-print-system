# ğŸ”§ ìˆ˜ëŸ‰ ë¡œë“œ ì˜¤ë¥˜ í•´ê²° ê°€ì´ë“œ

## ğŸ“‹ ë¬¸ì œ ìƒí™©
- littleprint í˜ì´ì§€ì—ì„œ êµ¬ë¶„ â†’ ì¢…ì´ì¢…ë¥˜ â†’ ì¢…ì´ê·œê²© ì„ íƒ í›„ ìˆ˜ëŸ‰ì´ ë¡œë“œë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ ë°œìƒ
- JavaScript ì½˜ì†”ì—ì„œ "ìˆ˜ëŸ‰ ë¡œë“œ ì˜¤ë¥˜" ë©”ì‹œì§€ í‘œì‹œ

## ğŸ” ì›ì¸ ë¶„ì„

### 1. AJAX ì‘ë‹µ í˜•ì‹ ë¶ˆì¼ì¹˜
- `get_quantities.php`: `success_response()` í•¨ìˆ˜ ì‚¬ìš© â†’ `{success: true, data: [...]}` í˜•ì‹
- `get_paper_types.php`, `get_paper_sizes.php`: `success_response()` í•¨ìˆ˜ ì‚¬ìš©
- JavaScriptì—ì„œ ì‘ë‹µ ì²˜ë¦¬ ë°©ì‹ì´ ì¼ê´€ë˜ì§€ ì•ŠìŒ

### 2. JavaScript ì‘ë‹µ ì²˜ë¦¬ ì˜¤ë¥˜
```javascript
// ì˜ëª»ëœ ì²˜ë¦¬ ë°©ì‹
.then(data => {
    data.forEach(option => { ... }); // dataëŠ” {success: true, data: [...]} í˜•ì‹
});

// ì˜¬ë°”ë¥¸ ì²˜ë¦¬ ë°©ì‹
.then(response => {
    response.data.forEach(option => { ... }); // response.data ì‚¬ìš©
});
```

### 3. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ëˆ„ë½
- ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ìˆ˜ëŸ‰ì´ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ
- ìˆ˜ë™ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼ í•˜ëŠ” ë¶ˆí¸í•¨

## âœ… í•´ê²° ë°©ë²•

### 1. AJAX ì‘ë‹µ í˜•ì‹ í†µì¼
ëª¨ë“  AJAX íŒŒì¼ì—ì„œ `success_response()` í•¨ìˆ˜ ì‚¬ìš©:

```php
// includes/functions.phpì— ì •ì˜ëœ ê³µí†µ í•¨ìˆ˜ ì‚¬ìš©
function success_response($data = null, $message = 'ì„±ê³µ') {
    json_response(true, $data, $message);
}

// ê° AJAX íŒŒì¼ì—ì„œ ì‚¬ìš©
mysqli_close($db);
success_response($quantities); // ë˜ëŠ” $options
```

### 2. JavaScript ì‘ë‹µ ì²˜ë¦¬ í†µì¼
ëª¨ë“  AJAX í˜¸ì¶œì—ì„œ ì¼ê´€ëœ ì‘ë‹µ ì²˜ë¦¬:

```javascript
fetch('ajax_file.php?params')
.then(response => response.json())
.then(response => {
    // ì„±ê³µ ì—¬ë¶€ í™•ì¸
    if (!response.success || !response.data) {
        console.error('ë¡œë“œ ì‹¤íŒ¨:', response.message);
        return;
    }
    
    // ë°ì´í„° ì²˜ë¦¬
    response.data.forEach(option => {
        // ì˜µì…˜ ì¶”ê°€ ë¡œì§
    });
    
    console.log('ì—…ë°ì´íŠ¸ ì™„ë£Œ:', response.data.length, 'ê°œ');
})
.catch(error => {
    console.error('AJAX ì˜¤ë¥˜:', error);
});
```

### 3. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì‹œ ìë™ ì—…ë°ì´íŠ¸:

```javascript
document.addEventListener('DOMContentLoaded', function() {
    const categorySelect = document.querySelector('select[name="MY_type"]');
    const paperTypeSelect = document.querySelector('select[name="TreeSelect"]');
    const paperSizeSelect = document.querySelector('select[name="PN_type"]');
    
    // êµ¬ë¶„ ë³€ê²½ ì‹œ
    if (categorySelect) {
        categorySelect.addEventListener('change', function() {
            changeCategoryType(this.value);
        });
    }
    
    // ì¢…ì´ì¢…ë¥˜ ë³€ê²½ ì‹œ
    if (paperTypeSelect) {
        paperTypeSelect.addEventListener('change', function() {
            updateQuantities();
        });
    }
    
    // ì¢…ì´ê·œê²© ë³€ê²½ ì‹œ
    if (paperSizeSelect) {
        paperSizeSelect.addEventListener('change', function() {
            updateQuantities();
        });
    }
});
```

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

### 1. `get_quantities.php`
```php
<?php
include "../../includes/functions.php";
include "../../db.php";

check_db_connection($db);
mysqli_set_charset($db, "utf8");

$style = $_GET['style'] ?? '';
$Section = $_GET['Section'] ?? '';
$TreeSelect = $_GET['TreeSelect'] ?? '';

if (empty($style) || empty($Section) || empty($TreeSelect)) {
    error_response('í•„ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.');
}

$TABLE = "MlangPrintAuto_littleprint";
$query = "SELECT DISTINCT quantity 
          FROM $TABLE 
          WHERE style='" . mysqli_real_escape_string($db, $style) . "' 
          AND Section='" . mysqli_real_escape_string($db, $Section) . "' 
          AND TreeSelect='" . mysqli_real_escape_string($db, $TreeSelect) . "'
          AND quantity IS NOT NULL 
          ORDER BY CAST(quantity AS UNSIGNED) ASC";

$result = mysqli_query($db, $query);
$quantities = [];

if ($result) {
    while ($row = mysqli_fetch_array($result)) {
        $quantities[] = [
            'value' => $row['quantity'],
            'text' => format_number($row['quantity']) . 'ë§¤'
        ];
    }
}

mysqli_close($db);
success_response($quantities);
?>
```

### 2. `index.php` JavaScript ë¶€ë¶„
- `updatePaperTypes()` í•¨ìˆ˜ ìˆ˜ì •
- `updatePaperSizes()` í•¨ìˆ˜ ìˆ˜ì •  
- `updateQuantities()` í•¨ìˆ˜ ìˆ˜ì •
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€

## ğŸ”„ ì ìš© ìˆœì„œ (ë‹¤ë¥¸ í’ˆëª©ì— ì ìš© ì‹œ)

### 1ë‹¨ê³„: ê³µí†µ í•¨ìˆ˜ í™•ì¸
- `includes/functions.php`ì— í•„ìš”í•œ í•¨ìˆ˜ë“¤ì´ ìˆëŠ”ì§€ í™•ì¸
- `success_response()`, `error_response()`, `format_number()` ë“±

### 2ë‹¨ê³„: AJAX íŒŒì¼ ìƒì„±/ìˆ˜ì •
- `get_paper_types.php`
- `get_paper_sizes.php`  
- `get_quantities.php`
- `calculate_price_ajax.php`

### 3ë‹¨ê³„: JavaScript í•¨ìˆ˜ êµ¬í˜„
- `updatePaperTypes()`
- `updatePaperSizes()`
- `updateQuantities()`
- `calculatePrice()`

### 4ë‹¨ê³„: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
- DOMContentLoaded ì´ë²¤íŠ¸ì—ì„œ ëª¨ë“  select ìš”ì†Œì— change ì´ë²¤íŠ¸ ì¶”ê°€

### 5ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹…
- ê° AJAX íŒŒì¼ì„ ì§ì ‘ URLë¡œ í…ŒìŠ¤íŠ¸
- ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ì—ì„œ ë„¤íŠ¸ì›Œí¬ íƒ­ í™•ì¸
- ì½˜ì†” ë¡œê·¸ë¡œ ë°ì´í„° íë¦„ í™•ì¸

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### 1. ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ëª… í™•ì¸
ê° í’ˆëª©ë³„ë¡œ í…Œì´ë¸”ëª…ì´ ë‹¤ë¦„:
- littleprint: `MlangPrintAuto_littleprint`
- namecard: `MlangPrintAuto_namecard`
- envelope: `MlangPrintAuto_envelope`

### 2. í•„ë“œëª… í™•ì¸
í’ˆëª©ë³„ë¡œ í•„ë“œëª…ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ:
- `style`, `Section`, `TreeSelect` ë“±ì˜ ì˜ë¯¸ì™€ ì‚¬ìš©ë²• í™•ì¸

### 3. ì‘ë‹µ í˜•ì‹ ì¼ê´€ì„±
- ëª¨ë“  AJAX íŒŒì¼ì—ì„œ ë™ì¼í•œ ì‘ë‹µ í˜•ì‹ ì‚¬ìš©
- JavaScriptì—ì„œë„ ì¼ê´€ëœ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬

### 4. ì—ëŸ¬ ì²˜ë¦¬
- í•„ìˆ˜ íŒŒë¼ë¯¸í„° ê²€ì¦
- ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ ì²˜ë¦¬
- JavaScriptì—ì„œ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬

## ğŸ“Š í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ì§ì ‘ URL í…ŒìŠ¤íŠ¸
```bash
curl "http://localhost/MlangPrintAuto/littleprint/get_quantities.php?style=590&Section=610&TreeSelect=679"
```

### 2. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬
- Network íƒ­ì—ì„œ AJAX ìš”ì²­/ì‘ë‹µ í™•ì¸
- Console íƒ­ì—ì„œ JavaScript ì˜¤ë¥˜ í™•ì¸

### 3. ë””ë²„ê·¸ íŒŒì¼ ìƒì„±
- ê° ë‹¨ê³„ë³„ë¡œ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” ë””ë²„ê·¸ íŒŒì¼ ìƒì„±
- ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ê²°ê³¼ ì§ì ‘ í™•ì¸

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `includes/functions.php`ì— í•„ìš”í•œ í•¨ìˆ˜ë“¤ ì •ì˜ë¨
- [ ] ëª¨ë“  AJAX íŒŒì¼ì´ `success_response()` ì‚¬ìš©
- [ ] JavaScriptì—ì„œ `response.data` í˜•ì‹ìœ¼ë¡œ ì²˜ë¦¬
- [ ] ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì‹œ ìë™ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸ ì¶”ê°€
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹… êµ¬í˜„
- [ ] ê° AJAX íŒŒì¼ ê°œë³„ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [ ] ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì™„ë£Œ

---

**ì‘ì„±ì¼**: 2025ë…„ 8ì›” 4ì¼  
**ì ìš© í’ˆëª©**: littleprint (ì†ŒëŸ‰í¬ìŠ¤í„°)  
**ë‹¤ìŒ ì ìš© ì˜ˆì •**: envelope, msticker, cadarok ë“±